
 RUN  v3.2.4 /Users/twin/Documents/filament/apps/filament-client-web

 ❯ tests/app-shell-chat-layout-contract.test.ts (3 tests | 1 failed) 5ms
   ✓ app shell chat layout contract > pins the composer by reserving a trailing chat-panel row 1ms
   × app shell chat layout contract > keeps message scrolling isolated above the composer 3ms
     → expected 0 to be greater than 0
   ✓ app shell chat layout contract > removes legacy composer internal selector dependencies 0ms
 ✓ tests/app-style-token-manifest.test.ts (25 tests) 11ms
 ✓ tests/check-app-shell-size-script.test.ts (4 tests) 300ms
 ❯ tests/username-cache.test.ts (3 tests | 2 failed) 7ms
   ✓ username cache > primes and invalidates cached usernames 1ms
   × username cache > deduplicates and caches lookups without refetching cached users 5ms
     → expected { Object (username, avatarVersion) } to be 'alice' // Object.is equality
   × username cache > stores negative cache entries for missing users 1ms
     → expected { Object (username, avatarVersion) } to be 'alice' // Object.is equality
 ✓ tests/app-shell-guild-creation-limits.test.tsx (2 tests) 231ms
 ✓ tests/app-shell-channel-kinds.test.tsx (2 tests) 293ms
 ✓ tests/app-shell-reactions.test.tsx (2 tests) 291ms
 ✓ tests/app-shell-public-discovery.test.tsx (1 test) 379ms
   ✓ app shell public discovery > loads and searches the authenticated public guild directory  378ms
 ✓ tests/app-shell-friendships.test.tsx (2 tests) 407ms
   ✓ app shell friendship flows > accepts incoming requests and removes friends  352ms
 ✓ tests/app-shell-message-history-scroll.test.tsx (4 tests) 424ms
 ✓ tests/app-shell-message-list.test.tsx (6 tests) 1321ms
   ✓ app shell message list > renders full dense history when scrolled away from latest  893ms
 ✓ tests/app-shell-composer-attachments.test.tsx (2 tests) 539ms
   ✓ app shell composer attachments > renders an image preview when attachment mime is generic after reload  311ms
 ✓ tests/app-shell-operator-permissions.test.tsx (2 tests) 811ms
   ✓ operator console permission fixtures > executes privileged operator flows for owner fixtures  738ms
 ✓ tests/app-shell-settings-entry.test.tsx (10 tests) 868ms
   ✓ app shell settings entry point > opens and closes client settings panel from account gear  358ms
 ✓ tests/app-shell-voice-controls.test.tsx (19 tests) 1235ms
 ✓ tests/app-shell-role-management-panel.test.tsx (5 tests) 148ms
 ✓ tests/app-shell-message-composer.test.tsx (3 tests) 118ms
 ✓ tests/app-shell-settings-panel.test.tsx (2 tests) 118ms
 ✓ tests/app-shell-message-row.test.tsx (2 tests) 101ms
 ✓ tests/app-shell-moderation-panel.test.tsx (3 tests) 121ms
 ✓ tests/app-shell-layout-components.test.tsx (12 tests) 179ms
 ✓ tests/app-shell-channel-rail.test.tsx (3 tests) 165ms
 ✓ tests/app-shell-channel-create-panel.test.tsx (2 tests) 88ms
 ✓ tests/app-shell-panel-host-props.test.tsx (5 tests) 115ms
 ✓ tests/routes-login.test.tsx (5 tests) 157ms
 ✓ tests/app-shell-attachments-panel.test.tsx (2 tests) 69ms
 ✓ tests/app-shell-chat-header.test.tsx (2 tests) 70ms
 ✓ tests/app-shell-friendships-panel.test.tsx (2 tests) 67ms
 ✓ tests/app-shell-member-rail.test.tsx (2 tests) 64ms
 ✓ tests/app-shell-public-directory-panel.test.tsx (2 tests) 62ms
 ✓ tests/app-shell-workspace-create-panel.test.tsx (3 tests) 70ms
 ✓ tests/app-shell-server-rail.test.tsx (2 tests) 66ms
 ✓ tests/app-shell-utility-panel.test.tsx (3 tests) 68ms
 ✓ tests/app-shell-search-panel.test.tsx (2 tests) 82ms
 ✓ tests/app-shell-workspace-settings-panel.test.tsx (2 tests) 104ms
 ✓ tests/app-shell-workspace-visibility.test.tsx (1 test) 56ms
 ✓ tests/app-shell-user-profile-overlay.test.tsx (2 tests) 81ms
 ✓ tests/rtc.test.ts (22 tests) 35ms
 ✓ tests/gateway.test.ts (16 tests) 13ms
 ✓ tests/app-shell-public-directory-controller.test.ts (5 tests) 7ms
 ✓ tests/api-boundary.test.ts (13 tests) 20ms
 ✓ tests/check-import-boundaries.test.ts (5 tests) 15ms
 ✓ tests/api-messages.test.ts (9 tests) 11ms
 ✓ tests/app-shell-composer-focus-controller.test.ts (6 tests) 11ms
 ✓ tests/app-shell-selectors.test.ts (6 tests) 7ms
 ✓ tests/app-shell-reaction-picker-controller.test.ts (2 tests) 10ms
 ✓ tests/api-workspace.test.ts (14 tests) 7ms
 ✓ tests/app-shell-reaction-picker-portal.test.tsx (1 test) 7ms
 ✓ tests/app-shell-message-list-controller.test.ts (4 tests) 5ms
 ✓ tests/app-shell-message-controller.test.ts (10 tests) 13ms
 ✓ tests/app-shell-voice-controller.test.ts (16 tests) 8ms
 ✓ tests/api-auth.test.ts (13 tests) 7ms
 ✓ tests/app-shell-message-history-controller.test.ts (5 tests) 7ms
 ✓ tests/app-shell-workspace-channel-operations-actions.test.ts (1 test) 3ms
 ✓ tests/domain-chat.test.ts (20 tests) 6ms
 ✓ tests/app-shell-role-management-controller.test.ts (2 tests) 19ms
 ✓ tests/app-shell-identity-resolution-controller.test.ts (3 tests) 4ms
 ✓ tests/app-shell-state.test.ts (5 tests) 6ms
 ✓ tests/app-shell-voice-device-actions.test.ts (3 tests) 16ms
 ✓ tests/app-shell-gateway-controller.test.ts (8 tests) 6ms
 ✓ tests/gateway-workspace-role-events.test.ts (11 tests) 6ms
 ✓ tests/api-auth-client.test.ts (3 tests) 5ms
 ✓ tests/gateway-workspace-member-remove-events.test.ts (4 tests) 2ms
 ✓ tests/app-shell-attachment-controller.test.ts (1 test) 6ms
 ✓ tests/app-shell-profile-controller.test.ts (3 tests) 5ms
 ✓ tests/app-shell-collaboration-panel-prop-groups.test.ts (1 test) 5ms
 ✓ tests/gateway-workspace-member-ban-events.test.ts (4 tests) 2ms
 ✓ tests/app-shell-collaboration-panel-prop-groups-options.test.ts (1 test) 5ms
 ✓ tests/app-shell-helpers.test.ts (10 tests) 6ms
 ✓ tests/api-workspace-client.test.ts (4 tests) 5ms
 ✓ tests/app-shell-friendship-controller.test.ts (2 tests) 4ms
 ✓ tests/app-shell-panel-host-prop-groups.test.ts (1 test) 5ms
 ✓ tests/gateway-presence-dispatch.test.ts (3 tests) 3ms
 ✓ tests/app-shell-session-diagnostics-actions.test.ts (1 test) 4ms
 ✓ tests/api-voice.test.ts (4 tests) 4ms
 ✓ tests/app-shell-session-diagnostics-controller.test.ts (4 tests) 5ms
 ✓ tests/voice-device-settings.test.ts (5 tests) 5ms
 ✓ tests/api-friends.test.ts (4 tests) 4ms
 ✓ tests/api-messages-client.test.ts (3 tests) 4ms
 ✓ tests/viewport-height.test.ts (3 tests) 4ms
 ✓ tests/api-voice-client.test.ts (4 tests) 4ms
 ✓ tests/browser-context.test.ts (5 tests) 4ms
 ✓ tests/app-shell-friendships-panel-props.test.ts (1 test) 3ms
 ✓ tests/app-shell-workspace-permission-actions.test.ts (3 tests) 5ms
 ✓ tests/app-shell-role-management-panel-props.test.ts (2 tests) 4ms
 ✓ tests/api-system.test.ts (4 tests) 4ms
 ✓ tests/api-friends-client.test.ts (3 tests) 4ms
 ✓ tests/app-shell-runtime-effects.test.ts (4 tests) 4ms
 ✓ tests/gateway-voice-dispatch.test.ts (3 tests) 3ms
 ✓ tests/app-shell-moderation-panel-props.test.ts (1 test) 3ms
 ✓ tests/app-shell-search-panel-props.test.ts (1 test) 3ms
 ✓ tests/app-shell-support-panel-prop-groups-options.test.ts (1 test) 3ms
 ✓ tests/app-shell-support-panel-prop-groups.test.ts (1 test) 4ms
 ✓ tests/app-shell-support-panel-host-state-options.test.ts (1 test) 4ms
 ✓ tests/app-shell-attachments-panel-props.test.ts (1 test) 5ms
 ✓ tests/app-shell-panel-host-prop-groups-options.test.ts (1 test) 2ms
 ✓ tests/gateway-workspace-member-events.test.ts (11 tests) 2ms
 ✓ tests/app-shell-search-controller.test.ts (1 test) 3ms
 ✓ tests/gateway-message-dispatch.test.ts (3 tests) 3ms
 ✓ tests/gateway-workspace-role-assignment-add-events.test.ts (4 tests) 6ms
 ✓ tests/app-shell-moderation-controller.test.ts (1 test) 3ms
 ✓ tests/app-shell-client-settings-panel-props.test.ts (2 tests) 3ms
 ✓ tests/app-shell-collaboration-panel-host-state-options.test.ts (1 test) 3ms
 ✓ tests/api-system-client.test.ts (2 tests) 3ms
 ✓ tests/app-shell-workspace-channel-create-panel-groups.test.ts (1 test) 3ms
 ✓ tests/gateway-workspace-dispatch.test.ts (3 tests) 9ms
 ✓ tests/gateway-message-events.test.ts (6 tests) 3ms
 ✓ tests/app-shell-workspace-channel-operations-controller.test.ts (2 tests) 3ms
 ✓ tests/gateway-friend-dispatch.test.ts (3 tests) 4ms
 ✓ tests/app-shell-public-directory-panel-props.test.ts (1 test) 7ms
 ✓ tests/gateway-voice-stream-events.test.ts (5 tests) 2ms
 ✓ tests/app-shell-workspace-channel-create-panel-groups-options.test.ts (1 test) 3ms
 ✓ tests/gateway-profile-dispatch.test.ts (3 tests) 3ms
 ✓ tests/gateway-workspace-events.test.ts (8 tests) 4ms
 ✓ tests/gateway-ready-dispatch.test.ts (3 tests) 3ms
 ✓ tests/app-shell-channel-create-panel-props.test.ts (1 test) 5ms
 ✓ tests/session-storage.test.ts (4 tests) 3ms
 ✓ tests/app-shell-workspace-create-panel-props.test.ts (1 test) 3ms
 ✓ tests/gateway-domain-dispatch.test.ts (3 tests) 3ms
 ✓ tests/app-shell-panel-host-prop-groups-factory.test.ts (1 test) 3ms
 ✓ tests/app-shell-utility-panel-props.test.ts (1 test) 2ms
 ✓ tests/gateway-voice-participant-events.test.ts (5 tests) 2ms
 ✓ tests/app-shell-workspace-controller.test.ts (4 tests) 3ms
 ✓ tests/app-shell-gateway-controller-registration.test.ts (1 test) 3ms
 ✓ tests/gateway-friend-events.test.ts (5 tests) 2ms
 ✓ tests/import-boundary-rules.test.ts (4 tests) 2ms
 ✓ tests/app-shell-workspace-settings-actions.test.ts (3 tests) 2ms
 ✓ tests/domain-auth.test.ts (4 tests) 2ms
 ✓ tests/app-shell-workspace-channel-create-panel-host-state-options.test.ts (1 test) 2ms
 ✓ tests/app-shell-workspace-settings-panel-props.test.ts (3 tests) 4ms
 ✓ tests/gateway-voice-events.test.ts (6 tests) 2ms
 ✓ tests/gateway-workspace-role-update-events.test.ts (4 tests) 2ms
 ✓ tests/app-shell-message-list-window.test.ts (8 tests) 2ms
 ✓ tests/gateway-presence-events.test.ts (4 tests) 2ms
 ✓ tests/gateway-workspace-role-assignment-events.test.ts (7 tests) 2ms
 ✓ tests/gateway-profile-events.test.ts (5 tests) 2ms
 ✓ tests/gateway-workspace-role-create-events.test.ts (4 tests) 4ms
 ✓ tests/gateway-workspace-member-update-events.test.ts (4 tests) 4ms
 ✓ tests/gateway-workspace-channel-override-events.test.ts (4 tests) 2ms
 ✓ tests/gateway-workspace-update-events.test.ts (4 tests) 2ms
 ✓ tests/gateway-envelope.test.ts (6 tests) 3ms
 ✓ tests/gateway-workspace-channel-events.test.ts (4 tests) 2ms
 ✓ tests/gateway-workspace-role-reorder-events.test.ts (4 tests) 5ms
 ✓ tests/app-shell-overlay-controller.test.ts (4 tests) 2ms
 ✓ tests/app-shell-runtime-labels.test.ts (2 tests) 1ms
 ✓ tests/gateway-workspace-role-delete-events.test.ts (4 tests) 2ms
 ✓ tests/gateway-workspace-ip-ban-events.test.ts (4 tests) 2ms
 ✓ tests/gateway-workspace-member-add-events.test.ts (4 tests) 2ms
 ✓ tests/gateway-workspace-role-assignment-remove-events.test.ts (4 tests) 2ms
 ✓ tests/app-shell-config.test.ts (1 test) 2ms
 ✓ tests/app-shell-workspace-selection-actions.test.ts (3 tests) 2ms
 ✓ tests/app-shell-overlay-panel-actions.test.ts (3 tests) 2ms
 ✓ tests/gateway-workspace-role-assignment-payload-events.test.ts (2 tests) 2ms
 ✓ tests/app-shell-async-operation-state.test.ts (1 test) 2ms
 ✓ tests/app-shell-diagnostics-event-counters.test.ts (2 tests) 2ms

 Test Files  2 failed | 153 passed (155)
      Tests  3 failed | 648 passed (651)
   Start at  22:52:58
   Duration  14.17s (transform 3.12s, setup 14.29s, collect 18.39s, tests 9.84s, environment 70.40s, prepare 10.17s)

